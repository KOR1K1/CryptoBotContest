# üèÜ Backend Auction Challenge ‚Äî production-grade auction system

> –≠—Ç–æ backend-—Å–∏—Å—Ç–µ–º–∞ –∞—É–∫—Ü–∏–æ–Ω–æ–≤ —Ü–∏—Ñ—Ä–æ–≤—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤, –≤–¥–æ—Ö–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –º–µ—Ö–∞–Ω–∏–∫–æ–π **Telegram Gift Auctions**. –Ø –Ω–µ –ø—ã—Ç–∞–ª—Å—è —É–≥–∞–¥–∞—Ç—å –∏–ª–∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω—é—é –ª–æ–≥–∏–∫—É Telegram ‚Äî –æ–Ω–∞ –≤—Å–µ —Ä–∞–≤–Ω–æ –Ω–µ –ø—É–±–ª–∏—á–Ω–∞. –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ —è —Å–º–æ—Ç—Ä–µ–ª –Ω–∞ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞, —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–ª –¥–æ–ø—É—â–µ–Ω–∏—è —Ç–∞–º, –≥–¥–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –Ω–µ—Ç, –∏ —Å—Ç—Ä–æ–∏–ª —Å–∏—Å—Ç–µ–º—É —Ç–∞–∫, –∫–∞–∫ –µ–µ –ø—Ä–∏—à–ª–æ—Å—å –±—ã –¥–µ–ª–∞—Ç—å –≤ —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ: —Å –¥–µ–Ω—å–≥–∞–º–∏, –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏–µ–π –∏ –Ω–∞–≥—Ä—É–∑–∫–æ–π.
–ü—Ä–æ–µ–∫—Ç –ø—Ä–æ –∞–∫–∫—É—Ä–∞—Ç–Ω—É—é —Ñ–∏–Ω–∞–Ω—Å–æ–≤—É—é –º–æ–¥–µ–ª—å, —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ race conditions –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É, –∫–æ—Ç–æ—Ä—É—é –Ω–µ —Å—Ç—ã–¥–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å.

[![GitHub](https://img.shields.io/badge/GitHub-Repository-181717?style=for-the-badge&logo=github)](https://github.com/KOR1K1/CryptoBotContest.git)
[![TypeScript](https://img.shields.io/badge/TypeScript-4.—Ö-blue?style=for-the-badge&logo=typescript&logoColor=white)](https://github.com/KOR1K1/CryptoBotContest.git)
[![NestJS 10.3.0](https://img.shields.io/badge/NestJS-E0234E?style=for-the-badge&logo=nestjs&logoColor=white)](https://github.com/KOR1K1/CryptoBotContest.git)
[![MongoDB](https://img.shields.io/badge/MongoDB-4.—Ö-green?style=for-the-badge&logo=mongodb&logoColor=white)](https://github.com/KOR1K1/CryptoBotContest.git)
[![Redis](https://img.shields.io/badge/Redis-6.—Ö-DC382D?style=for-the-badge&logo=redis&logoColor=white)](https://github.com/KOR1K1/CryptoBotContest.git)
[![Socket.IO](https://img.shields.io/badge/Socket.IO-010101?style=for-the-badge&logo=socket.io&logoColor=white)](https://github.com/KOR1K1/CryptoBotContest.git)

[![Last Commit](https://img.shields.io/github/last-commit/KOR1K1/CryptoBotContest?style=flat-square)](https://github.com/KOR1K1/CryptoBotContest.git)
[![License MIT](https://img.shields.io/github/license/KOR1K1/CryptoBotContest?style=flat-square)](https://github.com/KOR1K1/CryptoBotContest.git)


---

## –í–∏–¥–µ–æ-–¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞:

https://youtu.be/bJ4Xs78BjAo

## –û –ø—Ä–æ–µ–∫—Ç–µ

–≠—Ç–æ backend –¥–ª—è –º–Ω–æ–≥–æ–∫—Ä—É–≥–æ–≤–æ–≥–æ –∞—É–∫—Ü–∏–æ–Ω–∞ —Ü–∏—Ñ—Ä–æ–≤—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤. –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–æ–∫—É—Å ‚Äî –Ω–µ UI –∏ –Ω–µ ¬´—Ñ–∏—á–∏ —Ä–∞–¥–∏ —Ñ–∏—á¬ª, –∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –≤ —É—Å–ª–æ–≤–∏—è—Ö –≤—ã—Å–æ–∫–æ–π –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏–∏ –∏ –±–æ–ª—å—à–æ–≥–æ —á–∏—Å–ª–∞ —Å—Ç–∞–≤–æ–∫.

–ß—Ç–æ —è –¥–µ–ª–∞–ª –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ:

- ‚úÖ **–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª** –Ω–∞–±–ª—é–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –∞—É–∫—Ü–∏–æ–Ω–æ–≤,
- ‚úÖ —è–≤–Ω–æ **—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–ª** –≤—Å–µ –¥–æ–ø—É—â–µ–Ω–∏—è,
- ‚úÖ **–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–ª** —Å–∏—Å—Ç–µ–º—É —Ç–∞–∫, —á—Ç–æ–±—ã –µ–µ –º–æ–∂–Ω–æ –±—ã–ª–æ –æ–±—ä—è—Å–Ω–∏—Ç—å, –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ—Å–ª–µ —Å–±–æ–µ–≤.

### –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –ú–Ω–æ–≥–æ–∫—Ä—É–≥–æ–≤—ã–µ –∞—É–∫—Ü–∏–æ–Ω—ã: —Å—Ç–∞–≤–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–Ω–æ—Å—è—Ç—Å—è –º–µ–∂–¥—É —Ä–∞—É–Ω–¥–∞–º–∏.
- –§–∏–Ω–∞–Ω—Å—ã —á–µ—Ä–µ–∑ ledger: –∫–∞–∂–¥–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è, –Ω–∏—á–µ–≥–æ –Ω–µ ¬´—Ç–µ—Ä—è–µ—Ç—Å—è¬ª.
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å: –¥–µ–Ω—å–≥–∏ –Ω–µ –¥—É–±–ª–∏—Ä—É—é—Ç—Å—è –∏ –Ω–µ –∏—Å—á–µ–∑–∞—é—Ç.
- –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—è: MongoDB transactions –∏ Redis locks.
- –í—ã—Å–æ–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞: —Å–æ—Ç–Ω–∏ —Ç—ã—Å—è—á –∏ –º–∏–ª–ª–∏–æ–Ω—ã —Å—Ç–∞–≤–æ–∫ –≤ —Ä–∞—É–Ω–¥ –Ω–∞ –æ–¥–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ.
- Real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ WebSocket —Å throttling.
- –ü–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–æ–≤–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ: unit, integration –∏ –Ω–∞–≥—Ä—É–∑–æ—á–Ω—ã–µ —Ç–µ—Å—Ç—ã.

---

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

### Backend
- **Node.js 18+** —Å **TypeScript** (strict mode)
- **NestJS**
- **MongoDB** (replica set, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏)
- **Redis** (–∫–µ—à –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏)
- **Socket.IO**
- **Swagger / OpenAPI**

### Frontend
- **React**
- **WebSocket** –¥–ª—è live-–æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
- **Page Visibility API** –¥–ª—è —Å–Ω–∏–∂–µ–Ω–∏—è –ª–∏—à–Ω–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

### –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
- **Docker Compose**
- **Jest**
- **Pino** (–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ)
- **Helmet**
- **Rate Limiting**

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- **Swagger UI** ‚Äî –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (`/api/docs`)
- **[`SPEC.md`](./docs/SPEC.md)** ‚Äî –¥–µ—Ç–∞–ª—å–Ω–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è –º–µ—Ö–∞–Ω–∏–∫–∏ –∞—É–∫—Ü–∏–æ–Ω–∞
- **[`ASSUMPTIONS.md`](./docs/ASSUMPTIONS.md)** ‚Äî –≤—Å–µ —è–≤–Ω—ã–µ –¥–æ–ø—É—â–µ–Ω–∏—è
- **[`PERFORMANCE_OPTIMIZATION.md`](./PERFORMANCE_OPTIMIZATION.md)**, **[`PERFORMANCE_REPORT.md`](./PERFORMANCE_REPORT.md)** ‚Äî –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å

---

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Node.js >= 18.0.0
- Docker Desktop (–¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ MongoDB –∏ Redis)

### –ó–∞–ø—É—Å–∫ (–æ–¥–Ω–∞ –∫–æ–º–∞–Ω–¥–∞)

```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/KOR1K1/CryptoBotContest.git

cd CryptoBotContest

# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å .env —Ñ–∞–π–ª –∏–∑ .env.example
cp .env.example .env

# Windows PowerShell:
# Copy-Item .env.example .env

# –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ ‚Äî –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å .env
# (–ø–æ—Ä—Ç—ã, –∫—Ä–µ–¥—ã, –∫–ª—é—á–∏ –∏ —Ç.–¥.)

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
npm install

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å—ë (MongoDB, Redis, Backend, Frontend)
docker-compose up --build

```

### –ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞:

- Frontend: http://localhost:3001
- Backend API: http://localhost:3000
- Swagger: http://localhost:3000/api/docs

**–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ ‚Äî –≤** [`QUICKSTART.md`](./QUICKSTART.md)

---

## –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

API –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **JWT (JSON Web Tokens)** –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏. –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ —Ç—Ä–µ–±—É—é—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.

### –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –≤—Ö–æ–¥

#### 1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```bash
POST /auth/register
Content-Type: application/json

{
  "username": "testuser",
  "password": "securepassword123",
  "email": "user@example.com",  # –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
  "initialBalance": 10000        # –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –Ω–∞—á–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å
}
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "user": {
    "id": "507f1f77bcf86cd799439011",
    "username": "testuser",
    "email": "user@example.com",
    "balance": 10000,
    "lockedBalance": 0
  }
}
```

#### 2. –í—Ö–æ–¥

```bash
POST /auth/login
Content-Type: application/json

{
  "username": "testuser",
  "password": "securepassword123"
}
```

**–û—Ç–≤–µ—Ç:** –ê–Ω–∞–ª–æ–≥–∏—á–µ–Ω –æ—Ç–≤–µ—Ç—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ (JWT —Ç–æ–∫–µ–Ω + –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ)

#### 3. –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```bash
GET /auth/me
Authorization: Bearer <your-jwt-token>
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "id": "507f1f77bcf86cd799439011",
  "username": "testuser",
  "email": "user@example.com",
  "balance": 10000,
  "lockedBalance": 0,
  "createdAt": "2024-01-01T00:00:00.000Z"
}
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞

–ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞, –≤–∫–ª—é—á–∏—Ç–µ –µ–≥–æ –≤ –∑–∞–≥–æ–ª–æ–≤–æ–∫ `Authorization` –¥–ª—è –≤—Å–µ—Ö –∑–∞—â–∏—â–µ–Ω–Ω—ã—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤:

```bash
Authorization: Bearer <your-jwt-token>
```

**–ü—Ä–∏–º–µ—Ä: —Å–æ–∑–¥–∞–Ω–∏–µ –∞—É–∫—Ü–∏–æ–Ω–∞**

```bash
POST /auctions
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
Content-Type: application/json

{
  "giftId": "507f1f77bcf86cd799439011",
  "totalGifts": 10,
  "totalRounds": 3,
  "roundDurationMs": 60000,
  "minBid": 100
}
```

**–ü—Ä–∏–º–µ—Ä: —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ —Å—Ç–∞–≤–∫–∏**

```bash
POST /auctions/507f1f77bcf86cd799439011/bids
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
Content-Type: application/json

{
  "amount": 500
}
```

### –ó–∞—â–∏—â–µ–Ω–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

–≠–Ω–¥–ø–æ–∏–Ω—Ç—ã, —Ç—Ä–µ–±—É—é—â–∏–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (üîí):

- `POST /auctions` - —Å–æ–∑–¥–∞–Ω–∏–µ –∞—É–∫—Ü–∏–æ–Ω–∞
- `POST /auctions/:id/start` - –∑–∞–ø—É—Å–∫ –∞—É–∫—Ü–∏–æ–Ω–∞ (—Ç–æ–ª—å–∫–æ —Å–æ–∑–¥–∞—Ç–µ–ª—å)
- `POST /auctions/:id/bids` - —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ —Å—Ç–∞–≤–∫–∏
- `POST /gifts` - —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–¥–∞—Ä–∫–∞
- `PUT /gifts/:id` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–¥–∞—Ä–∫–∞
- `DELETE /gifts/:id` - —É–¥–∞–ª–µ–Ω–∏–µ –ø–æ–¥–∞—Ä–∫–∞
- `GET /users/:id` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
- `GET /users/:id/balance` - –ø–æ–ª—É—á–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `GET /users/:id/bids` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞–≤–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `GET /auth/me` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### WebSocket –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Ç–∞–∫–∂–µ —Ç—Ä–µ–±—É—é—Ç JWT —Ç–æ–∫–µ–Ω:

```javascript
import { io } from 'socket.io-client';

const socket = io('http://localhost:3000', {
  auth: {
    token: 'your-jwt-token'
  }
});
```

### –°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è —Ç–æ–∫–µ–Ω–∞

–¢–æ–∫–µ–Ω—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã –≤ —Ç–µ—á–µ–Ω–∏–µ **24 —á–∞—Å–æ–≤** (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è `JWT_EXPIRES_IN`).

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –ü–∞—Ä–æ–ª–∏ —Ö–µ—à–∏—Ä—É—é—Ç—Å—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **bcrypt** (10 —Ä–∞—É–Ω–¥–æ–≤)
- JWT —Ç–æ–∫–µ–Ω—ã –ø–æ–¥–ø–∏—Å—ã–≤–∞—é—Ç—Å—è —Å–µ–∫—Ä–µ—Ç–Ω—ã–º –∫–ª—é—á–æ–º (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `JWT_SECRET`)
- –ó–∞—â–∏—Ç–∞ –æ—Ç brute-force —á–µ—Ä–µ–∑ rate limiting
- CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

**–í–∞–∂–Ω–æ:** –í production –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å–∏–ª—å–Ω—ã–π `JWT_SECRET` –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è!

---

## –ß—Ç–æ –∑–¥–µ—Å—å —Å–¥–µ–ª–∞–Ω–æ –∏–Ω–∞—á–µ (–∏ –ø–æ—á–µ–º—É)

### 1. –§–∏–Ω–∞–Ω—Å—ã —á–µ—Ä–µ–∑ ledger

**–í –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ pet-–ø—Ä–æ–µ–∫—Ç–æ–≤** –±–∞–ª–∞–Ω—Å –ø—Ä–æ—Å—Ç–æ —É–º–µ–Ω—å—à–∞—é—Ç —á–∏—Å–ª–æ–º. –≠—Ç–æ —É–¥–æ–±–Ω–æ, –Ω–æ –±–µ—Å–ø–æ–ª–µ–∑–Ω–æ, –µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫.

–ó–¥–µ—Å—å –∫–∞–∂–¥–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è ‚Äî –æ—Ç–¥–µ–ª—å–Ω–∞—è –∑–∞–ø–∏—Å—å –≤ immutable ledger. –ë–∞–ª–∞–Ω—Å –º–æ–∂–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏, –∞ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è —è–≤–Ω–æ:
balance >= 0, lockedBalance >= 0, balance + lockedBalance = const.

–≠—Ç–æ –º–µ–¥–ª–µ–Ω–Ω–µ–µ –Ω–∞ –±—É–º–∞–≥–µ, –Ω–æ –∏–º–µ–Ω–Ω–æ —Ç–∞–∫ —Å–∏—Å—Ç–µ–º—ã –ø–µ—Ä–µ–∂–∏–≤–∞—é—Ç –±–∞–≥–∏ –∏ –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã.

```typescript
// –í–º–µ—Å—Ç–æ –ø—Ä–æ—Å—Ç–æ: user.balance -= amount
// –î–µ–ª–∞–µ–º:
await LedgerEntry.create({
  userId,
  type: 'LOCK',
  amount,
  referenceId: bid._id
});
await User.updateOne({ _id: userId }, {
  $inc: { balance: -amount, lockedBalance: +amount }
});
```

### 2. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –Ω–µ —Ä–∞–∑–º–∞–∑–∞–Ω–∞ –ø–æ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞–º. –û–Ω–∞ –∂–∏–≤–µ—Ç –≤ domain-—Å–µ—Ä–≤–∏—Å–∞—Ö: AuctionService, BidService, BalanceService.
–ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã –¥–µ–ª–∞—é—Ç —Ä–æ–≤–Ω–æ —Ç–æ, —á—Ç–æ –¥–æ–ª–∂–Ω—ã: –≤–∞–ª–∏–¥–∞—Ü–∏—è, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è, –≤—ã–∑–æ–≤ —Å–µ—Ä–≤–∏—Å–æ–≤.

–í –∏—Ç–æ–≥–µ:

- —Å–µ—Ä–≤–∏—Å—ã –ª–µ–≥–∫–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å,
- –ª–æ–≥–∏–∫—É –º–æ–∂–Ω–æ —á–∏—Ç–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ –æ—Ç HTTP,
- –∫–æ–¥ –Ω–µ –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –∫–∞—à—É –ø–æ –º–µ—Ä–µ —Ä–æ—Å—Ç–∞.

### 3. –ö–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ—Å—Ç—å –∏ –Ω–∞–≥—Ä—É–∑–∫–∞

–û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Å—Ç–∞–≤–∫–∏ ‚Äî –æ—Å–Ω–æ–≤–Ω–∞—è –±–æ–ª—å –∞—É–∫—Ü–∏–æ–Ω–æ–≤. –ó–¥–µ—Å—å –æ–Ω–∞ —Ä–µ—à–∞–µ—Ç—Å—è –∫–æ–º–±–∏–Ω–∞—Ü–∏–µ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π MongoDB –∏ Redis-–±–ª–æ–∫–∏—Ä–æ–≤–æ–∫. –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ retry —Å backoff.

–ö–ª—é—á–µ–≤—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:

- –≤—ã–±–æ—Ä –ø–æ–±–µ–¥–∏—Ç–µ–ª—è —á–µ—Ä–µ–∑ .limit(), –∞ –Ω–µ –∑–∞–≥—Ä—É–∑–∫—É –≤—Å–µ—Ö —Å—Ç–∞–≤–æ–∫;
- –≤–æ–∑–≤—Ä–∞—Ç—ã –¥–µ–Ω–µ–≥ –±–∞—Ç—á–∞–º–∏ –ø–æ cursor pagination;
- –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ dashboard-–∑–∞–ø—Ä–æ—Å–æ–≤;
- WebSocket-–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–∞—Ç—á–∞–º–∏ —Ä–∞–∑ –≤ 100 –º—Å.

### 4. –ú–µ—Ö–∞–Ω–∏–∫–∞ —Ä–∞—É–Ω–¥–æ–≤

–ù–∏–∫–∞–∫–∏—Ö setTimeout. –°–æ—Å—Ç–æ—è–Ω–∏–µ —Ä–∞—É–Ω–¥–∞ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –±–∞–∑–µ, –ø–µ—Ä–µ—Ö–æ–¥—ã –¥–µ–ª–∞–µ—Ç scheduler. –°–µ—Ä–≤–∏—Å –º–æ–∂–Ω–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç ‚Äî –æ–Ω –ø—Ä–æ–¥–æ–ª–∂–∏—Ç —Å —Ç–æ–≥–æ –∂–µ –º–µ—Å—Ç–∞.

–ü–æ–∑–¥–Ω–∏–µ —Å—Ç–∞–≤–∫–∏ –Ω–µ –ø—Ä–æ–¥–ª–µ–≤–∞—é—Ç —Ä–∞—É–Ω–¥, –∞ –ø–µ—Ä–µ—Ö–æ–¥—è—Ç –≤ —Å–ª–µ–¥—É—é—â–∏–π. –≠—Ç–æ —É–±–∏—Ä–∞–µ—Ç ¬´–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–µ–∫—É–Ω–¥—ã¬ª –∏ –¥–µ–ª–∞–µ—Ç –º–µ—Ö–∞–Ω–∏–∫—É –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ–π.

–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (single server):
- 10k‚Äì100k —Å—Ç–∞–≤–æ–∫: —Å–æ—Ç–Ω–∏ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥ –Ω–∞ –≤—ã–±–æ—Ä –ø–æ–±–µ–¥–∏—Ç–µ–ª—è.
- 100k‚Äì1M: –¥–æ –ø–æ–ª—É—Å–µ–∫—É–Ω–¥—ã.
- 1M‚Äì10M: —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ —É–∂–µ —Ç—Ä–µ–±—É–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞.

–í—Å–µ —Ü–∏—Ñ—Ä—ã –ø–æ–ª—É—á–µ–Ω—ã –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –Ω–∞–≥—Ä—É–∑–æ—á–Ω—ã—Ö —Ç–µ—Å—Ç–∞—Ö. –ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ ‚Äî –≤ [`PERFORMANCE_REPORT.md`](./PERFORMANCE_REPORT.md)

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü–æ–∫—Ä—ã—Ç—ã:

- —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã,
- –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã–µ —Å—Ç–∞–≤–∫–∏,
- –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å,
- –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –≤–æ–∑–≤—Ä–∞—Ç–æ–≤,
- –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –≤—ã–±–æ—Ä–∞ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è.

–¢–µ—Å—Ç—ã ‚Äî –Ω–µ ¬´–¥–ª—è –≥–∞–ª–æ—á–∫–∏¬ª, –∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–∞–º—ã—Ö –Ω–µ–ø—Ä–∏—è—Ç–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤.

### –ö–ª—é—á–µ–≤—ã–µ —Ç–µ—Å—Ç—ã

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
npm test

# –° –ø–æ–∫—Ä—ã—Ç–∏–µ–º
npm run test:cov

# Watch mode
npm run test:watch
```

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã**:
- ‚úÖ –§–∏–Ω–∞–Ω—Å–æ–≤–∞—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å (–∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã –±–∞–ª–∞–Ω—Å–∞)
- ‚úÖ –ö–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã–µ —Å—Ç–∞–≤–∫–∏ (race conditions)
- ‚úÖ –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–π (–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ retry)
- ‚úÖ Winner selection (–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å)
- ‚úÖ Refund correctness (–±–∞—Ç—á–∏–Ω–≥, –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞)

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
src/
‚îú‚îÄ‚îÄ models/              # Mongoose schemas (User, Auction, Bid, LedgerEntry)
‚îú‚îÄ‚îÄ services/            # Domain services
‚îÇ   ‚îú‚îÄ‚îÄ auction/        # AuctionService ‚Äî core business logic
‚îÇ   ‚îú‚îÄ‚îÄ bid/            # BidService ‚Äî bid management
‚îÇ   ‚îú‚îÄ‚îÄ balance/        # BalanceService ‚Äî financial operations
‚îÇ   ‚îú‚îÄ‚îÄ scheduler/      # RoundSchedulerService ‚Äî round transitions
‚îÇ   ‚îú‚îÄ‚îÄ throttler/      # BidUpdateThrottlerService ‚Äî WebSocket optimization
‚îÇ   ‚îî‚îÄ‚îÄ redis-lock/     # RedisLockService ‚Äî distributed locks
‚îú‚îÄ‚îÄ controllers/         # API endpoints (—Ç–æ–ª—å–∫–æ –≤–∞–ª–∏–¥–∞—Ü–∏—è + –≤—ã–∑–æ–≤ —Å–µ—Ä–≤–∏—Å–æ–≤)
‚îú‚îÄ‚îÄ gateways/           # WebSocket gateway (real-time updates)
‚îú‚îÄ‚îÄ config/             # Configuration
‚îî‚îÄ‚îÄ integration/        # Integration tests

docs/
‚îú‚îÄ‚îÄ SPEC.md             # üìÑ –î–µ—Ç–∞–ª—å–Ω–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è –º–µ—Ö–∞–Ω–∏–∫–∏
‚îú‚îÄ‚îÄ ASSUMPTIONS.md      # üìù –í—Å–µ —è–≤–Ω—ã–µ –¥–æ–ø—É—â–µ–Ω–∏—è
‚îî‚îÄ‚îÄ PERFORMANCE_*.md    # üìä –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
```

---

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- Helmet –∏ CORS
- rate limiting –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —É—Ä–æ–≤–Ω—è—Ö
- —Å—Ç—Ä–æ–≥–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è DTO
- –±–∞–∑–æ–≤–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è WebSocket
- —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ MongoDB –∫–∞–∫ –∑–∞—â–∏—Ç–∞ –æ—Ç race conditions

---

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ò–ò

–ò–ò –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ: –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–¥–∞ –∏ –ø–æ–∏—Å–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏.
–í—Å–µ —Ä–µ—à–µ–Ω–∏—è –ø—Ä–∏–Ω–∏–º–∞–ª–∏—Å—å –≤—Ä—É—á–Ω—É—é, –∫–∞–∂–¥–∞—è —á–∞—Å—Ç—å –ª–æ–≥–∏–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–ª–∞—Å—å, –≤—Å–µ –¥–æ–ø—É—â–µ–Ω–∏—è –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω—ã –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏.

---

## –ü–æ—á–µ–º—É —ç—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –≤–æ–æ–±—â–µ –∏–º–µ–µ—Ç —Å–º—ã—Å–ª

–≠—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–µ –ø—Ä–æ ¬´–∏–¥–µ–∞–ª—å–Ω–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –¢–ó¬ª. –û–Ω –ø—Ä–æ —Ç–æ, –∫–∞–∫ backend-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –¥—É–º–∞–µ—Ç –æ –ø—Ä–æ–¥—É–∫—Ç–µ:

- –∫–∞–∫ –æ–±—Ä–∞—â–∞—Ç—å—Å—è —Å –¥–µ–Ω—å–≥–∞–º–∏,
- –∫–∞–∫ –ø–µ—Ä–µ–∂–∏–≤–∞—Ç—å —Å–±–æ–∏,
- –∫–∞–∫ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å—Å—è,
- –∫–∞–∫ –æ—Å—Ç–∞–≤–ª—è—Ç—å –ø–æ—Å–ª–µ —Å–µ–±—è —Å–∏—Å—Ç–µ–º—É, –∞ –Ω–µ –Ω–∞–±–æ—Ä —Ñ–∞–π–ª–æ–≤.

---

## üöÄ Roadmap (–º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å)

### Single Server (—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)
- ‚úÖ 100k-1M bids/round —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è–º–∏

### Large Scale (1M-10M bids/round) ‚Äî —Ç—Ä–µ–±—É–µ—Ç –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è
- [ ] Horizontal scaling (multiple API instances + load balancer)
- [ ] Socket.IO Redis adapter (multi-server WebSocket)
- [ ] MongoDB replica set —Å read replicas
- [ ] Message queue –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å—Ç–∞–≤–æ–∫

**–ü–æ–¥—Ä–æ–±–Ω–µ–µ**: [`SINGLE_SERVER_OPTIMIZATIONS.md`](./docs/SINGLE_SERVER_OPTIMIZATIONS.md)

---

## –ò—Ç–æ–≥

–≠—Ç–æ production-grade backend –∞—É–∫—Ü–∏–æ–Ω–∞ —Å –Ω–æ—Ä–º–∞–ª—å–Ω–æ–π —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–π –º–æ–¥–µ–ª—å—é, —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å—é –∫ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏–∏ –∏ –ø–æ–Ω—è—Ç–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π.
–ù–µ –∏–¥–µ–∞–ª—å–Ω—ã–π. –ó–∞—Ç–æ —á–µ—Å—Ç–Ω—ã–π, –ø—Ä–æ–≤–µ—Ä—è–µ–º—ã–π –∏ –ø—Ä–∏–≥–æ–¥–Ω—ã–π –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.